<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, viewport-fit=cover"
  />
  <title>SteadyStateVR</title>

  <!-- A-Frame core -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <!-- Extras: animation mixer + nav helpers -->
  <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
  <!-- Look-at so NPC tracks the camera a bit -->
  <script src="https://cdn.jsdelivr.net/npm/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- HUD -->
  <div id="loadingScreen">
    <div>Loading SteadyStateVR</div>
    <div class="pulse">Please wait…</div>
  </div>

  <div id="hint" class="hud-top">
    Quest: point with controller ray & pull trigger. Desktop: drag to look, WASD to move.<br/>
    Voice: <b>Enable Microphone</b> → <b>Speak Now</b>. Otherwise, choose an on-panel option.
  </div>

  <!-- Offscreen canvas for saving feedback card as PNG -->
  <canvas id="exportCanvas" width="880" height="560"></canvas>

  <a-scene
    background="color: #D2B48C"
    webxr="requiredFeatures: local-floor; optionalFeatures: hand-tracking"
    loading-screen="enabled: false"
    vr-mode-ui="enabled: true"
  >
    <!-- scene background -->
    <a-assets>
      <img id="museum" src="images/dinosaur1.png">
    </a-assets>
    <a-sky src="#museum"></a-sky>

    <!-- Camera rig + cursor + controller rays -->
    <a-entity id="rig" position="0 2.2 3.3">
      <a-entity id="camera" camera look-controls wasd-controls="acceleration: 10">
        <a-entity
          id="gazeCursor"
          cursor="fuse:false"
          position="0 0 -1"
          geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.015"
          material="color: #e2e8f0; shader: flat; opacity: .85"
          raycaster="objects: .clickable"
        ></a-entity>
      </a-entity>
      <a-entity id="rightHand" laser-controls="hand: right" raycaster="objects: .clickable; far: 9;"></a-entity>
      <a-entity id="leftHand"  laser-controls="hand: left"  raycaster="objects: .clickable; far: 9;"></a-entity>
    </a-entity>

    <!-- Lighting + floor -->
    <a-entity light="type: hemisphere; color: #fff; groundColor: #223; intensity: 1.0"></a-entity>
    <a-entity geometry="primitive: plane; width: 36; height: 36" rotation="-90 0 0"
              material="color: #101827; roughness: 1"></a-entity>

    <!-- Hover dot for ray hits -->
    <a-entity id="hoverDot" geometry="primitive: sphere; radius: 0.01"
              material="color: #93c5fd" visible="false"></a-entity>

    <a-assets>
    <!-- Student models -->
    <a-asset-item id="studentA" src="studentB.glb"></a-asset-item>
    <a-asset-item id="studentB" src="studentB.glb"></a-asset-item>
    <a-asset-item id="studentC" src="studentC.glb"></a-asset-item>
  </a-assets>

  <!-- Students in the scene -->
  <a-entity id="StudentA" gltf-model="url(models/StudentB.glb)" position="-0.8 0 -2.2" rotation="0 165 0" scale="0.78 0.78 0.78" animation-mixer="clip: Idle; loop: repeat" look-at="#camera"> </a-entity>
  <a-entity id="StudentB" gltf-model="url(models/StudentB.glb)" position="-1.4 0 -2.2" rotation="0 165 0" scale="0.78 0.78 0.78" animation-mixer="clip: Idle; loop: repeat" look-at="#camera"> </a-entity>
  <a-entity id="StudentC" gltf-model="url(models/StudentC.glb)" position="1.4 0 -2.2" rotation="0 165 0" scale="0.78 0.78 0.78" animation-mixer="clip: Idle; loop: repeat" look-at="#camera"> </a-entity>

  <!-- Text UI -->
  <a-entity id="dialogueBox" text="value: ; width: 4; wrapCount: 40;" position="0 2 -2"></a-entity>

  <!-- Options UI -->
  <a-entity id="options" visible="false">
    <a-plane id="opt1" position="-1 1 -2" width="1.8" height="0.5" color="#333"></a-plane>
    <a-plane id="opt2" position="0 1 -2" width="1.8" height="0.5" color="#333"></a-plane>
    <a-plane id="opt3" position="1 1 -2" width="1.8" height="0.5" color="#333"></a-plane>

    <a-entity id="opt1text" text="value: ; align: center; wrapCount: 20;" position="-1 1 -1.9"></a-entity>
    <a-entity id="opt2text" text="value: ; align: center; wrapCount: 20;" position="0 1 -1.9"></a-entity>
    <a-entity id="opt3text" text="value: ; align: center; wrapCount: 20;" position="1 1 -1.9"></a-entity>
  </a-entity>

  <!-- Feedback screen -->
  <a-plane id="feedback" position="0 1.5 -2" width="3.5" height="2" color="#111" visible="false">
    <a-entity id="feedbackText" text="value: ; wrapCount: 40;" position="0 0 0.1"></a-entity>
  </a-plane>
  </a-scene>
</body>
</html>